{% extends "blueprint.html" %}
{% block meta %} 
<script defer type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
{% endblock %}
{% block body %}


	<div id="data">
		<div id="buttons">
			<button type="button" id="downloadexcel" onclick="ExportToExcel('xlsx')">Download Report</button>
		</div>
		<div id="balanceSheet"></div>
	</div>

<script>
	window.bsData = {{data|tojson}}
</script>
<script src="{{ url_for('static', filename='react/compiled/mobileBalanceSheetTable.js') }}"></script>
<script src="{{ url_for('static', filename='js/balanceSheet.js') }}"></script>
<script>
	function ExportToExcel(type, fn, dl) {
		var elt = document.getElementById("balanceSheet");
		var wb = XLSX.utils.table_to_book(elt, { sheet: "sheet1" });
		return dl
			? XLSX.write(wb, { bookType: type, bookSST: true, type: "base64" })
			: XLSX.writeFile(wb, fn || "BalanceSheet." + (type || "xlsx"));
	}
</script>
{% endblock %}
